## Caching
### 캐싱이란?
- 동일한 데이터에 반복해서 접근해야 하거나 많은 연산이 필요한 경우에 결과를 빠르게 이용하고자 성능이 좋은 혹은 가까운 곳에 저장하는 것

---

### 대상 API
- 콘서트 조회 API
- 예약 가능 일정 조회 API
- 예약 가능 좌석 조회 API

---

### API 별 선정 이유
1. 콘서트 조회 API
- 콘서트 예약을 위해서는 콘서트 조회가 필수이기 때문에 Hit Rate가 높을 것으로 판단
- 페이징 처리를 통해 쿼리 비용이 발생 (페이징을 하지 않고 전체 조회를 하면 그것은 쿼리 비용이 아닌 네트워크 비용의 영역)
- 값 변경이 자주 일어나지 않음
2. 예약 가능 일정 조회 API
- 인기가 없는 콘서트의 경우 Hit Rate가 낮을 수도 있지만 반대의 경우 Hit Rate가 높을 것으로 판단
- 인기가 많은 콘서트의 경우 값 변경이 자주 일어나지만 반대의 경우 값 변경이 자주 일어나지 않음
- 예약 '가능' 일정 조회이기 때문에 쿼리 비용이 발생 (날짜가 지난 일정은 조회하지 않는 쿼리)
3. 예약 가능 좌석 조회 API
- 예약을 위해 많은 조회 요청이 있을 것으로 판단
- 쿼리 비용이 발생
- 값 변경이 빈번하여 Hit Rate가 매우 낮아질 수도 있지만 적절한 캐싱 전략을 통해 개선 가능하다 판단

---

### 의견
1. 콘서트 조회 API
- 5천 건을 한 번에 조회 하였을 때 쿼리 비용이 드는 것이 아니라 네트워크 비용이 드는 것에 가까우므로 캐싱으로 유의미한 효과를 보기에는 어려움이 있었습니다.  
하지만 많은 양의 데이터를 한 번에 조회 하는 것은 속도도 느리고 성능적으로 좋지 못 하기 때문에 페이징 처리를 추가 하였고,  
페이징 처리를 추가 하고 나니 쿼리 비용이 생겨 캐싱이 눈에 보이는 성능 향상 효과를 주었습니다.
2. 예약 가능 일정 조회 API
- 예약 가능 일정 조회의 경우 콘서트와 날짜 데이터를 가지고 쿼리를 던지기 때문에 쿼리 비용이 발생하였고,  
값이 쉽게 변하지 않아 ttl을 길게 가져가면서 Hit Rate가 높아질 것으로 기대합니다.
3. 예약 가능 좌석 조회 API
- 예약 가능 좌석 조회의 경우 위와 동일하게 쿼리 비용이 발생하지만 빈번하게 상태가 변하기 때문에 expiration ttl 주기를 짧게 가져가고,  
eviction 전략을 더한 hybrid 방식으로 좌석의 상태 값이 변하면 eviction 시켜서 다시 캐싱 처리 하는 전략으로 캐싱처리를 하였고,  
이로 인해 상태가 자주 변하는 좌석의 경우지만 조회가 잦으므로 해당 전략은 유의미한 성능 향상 효과를 가져다 주었습니다.  
트래픽이 많아지면 많아질수록 효과는 더욱 좋아질 것이라 기대합니다.

---

### 성능 비교

#### 콘서트 조회 API
###### (좌)-콘서트 Page0 노캐싱 (우)-콘서트 Page0 캐싱
![](cache_screen/콘서트Page0(노캐싱).png) ![](cache_screen/콘서트Page0(캐싱).png)
###### (좌)-콘서트 Page1 노캐싱 (우)-콘서트 Page1 캐싱
![](cache_screen/콘서트Page1(노캐싱).png) ![](cache_screen/콘서트Page1(캐싱).png)
###### (좌)-콘서트 Page2 노캐싱 (우)-콘서트 Page2 캐싱
![](cache_screen/콘서트Page2(노캐싱).png) ![](cache_screen/콘서트Page2(캐싱).png)

#### 예약 가능 일정 조회 API
###### (좌)-예약 가능 일정 노캐싱 (우)-예약 가능 일정 캐싱
![](cache_screen/예약가능일정조회(노캐싱).png) ![](cache_screen/예약가능일정조회(캐싱).png)

#### 예약 가능 좌석 조회 API
###### (좌)-예약 가능 좌석 노캐싱 (우)-예약 가능 좌석 캐싱
![](cache_screen/예약가능좌석조회(노캐싱).png) ![](cache_screen/예약가능좌석조회(캐싱).png)